<?xml version="1.0"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

  <import resource="context-application.xml" />

  <bean id="stockServiceFacade" parent="baseTransactionProxy">
    <property name="target">
      <bean
        class="fr.peralta.mycellar.interfaces.facades.stock.StockServiceFacadeImpl"
        p:stockService-ref="stockService" p:mapperServiceFacade-ref="mapperServiceFacade" />
    </property>
  </bean>

  <bean id="userServiceFacade" parent="baseTransactionProxy">
    <property name="target">
      <bean
        class="fr.peralta.mycellar.interfaces.facades.user.UserServiceFacadeImpl"
        p:userService-ref="userService" p:mapperServiceFacade-ref="mapperServiceFacade" />
    </property>
  </bean>

  <bean id="wineServiceFacade" parent="baseTransactionProxy">
    <property name="target">
      <bean
        class="fr.peralta.mycellar.interfaces.facades.wine.WineServiceFacadeImpl"
        p:countryService-ref="countryService" p:mapperServiceFacade-ref="mapperServiceFacade" />
    </property>
  </bean>

  <bean id="baseTransactionProxy"
    class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean"
    abstract="true">
    <property name="transactionManager" ref="transactionManager" />
    <property name="transactionAttributes">
      <props>
        <prop key="new*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="mapperServiceFacade"
    class="fr.peralta.mycellar.interfaces.facades.shared.MapperServiceFacade" />

  <!-- Image aggregate -->
  <bean id="imageMapper"
    class="fr.peralta.mycellar.interfaces.facades.image.mappers.ImageMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="imageDtoMapper"
    class="fr.peralta.mycellar.interfaces.facades.image.mappers.ImageDtoMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>

  <!-- Position aggregate -->
  <bean id="mapMapper"
    class="fr.peralta.mycellar.interfaces.facades.position.mappers.MapMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="mapDtoMapper"
    class="fr.peralta.mycellar.interfaces.facades.position.mappers.MapDtoMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="positionMapper"
    class="fr.peralta.mycellar.interfaces.facades.position.mappers.PositionMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="positionDtoMapper"
    class="fr.peralta.mycellar.interfaces.facades.position.mappers.PositionDtoMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>

  <!-- Stock aggregate -->
  <bean id="bottleMapper"
    class="fr.peralta.mycellar.interfaces.facades.stock.mappers.BottleMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>

  <!-- User aggregate -->
  <bean id="usermapper"
    class="fr.peralta.mycellar.interfaces.facades.user.mappers.UserMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="userDtoMapper"
    class="fr.peralta.mycellar.interfaces.facades.user.mappers.UserDtoMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>

  <!-- Wine aggregate -->
  <bean id="countryMapper"
    class="fr.peralta.mycellar.interfaces.facades.wine.mappers.CountryMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>
  <bean id="countryDtoMapper"
    class="fr.peralta.mycellar.interfaces.facades.wine.mappers.CountryDtoMapper"
    init-method="initialize">
    <property name="mapperServiceFacade" ref="mapperServiceFacade" />
  </bean>

</beans>